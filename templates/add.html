{% extends "base.html" %}
{% block content %}
<h2>Add Transaction</h2>
<form method="post">
  <label>Type</label>
  <select name="type" required onchange="onTypeChange(this.value)">
    <option value="income">Income</option>
    <option value="expense">Expense</option>
  </select>

  <label>Amount</label>
  <input name="amount" type="number" step="0.01" required />

  <label>Category</label>
  <select id="category" name="category" required>
    <!-- will be populated by JS -->
  </select>

  <label>Date (optional)</label>
  <input name="date" type="datetime-local" />

  <label>Note</label>
  <input name="note" type="text" />

  <button type="submit">Add Transaction</button>
</form>

<script>
const incomeCategories = {{ income_categories|tojson }};
const expenseCategories = {{ expense_categories|tojson }};

function populateCategories(list) {
  const sel = document.getElementById('category');
  sel.innerHTML = '';
  list.forEach(c => {
    const opt = document.createElement('option');
    opt.value = c;
    opt.textContent = c.charAt(0).toUpperCase() + c.slice(1);
    sel.appendChild(opt);
  });
}
function onTypeChange(val){
  if(val === 'income') populateCategories(incomeCategories);
  else populateCategories(expenseCategories);
}
// init
populateCategories(incomeCategories);
</script>
{% endblock %}
